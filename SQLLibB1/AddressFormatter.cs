using Microsoft.SqlServer.Server;
using System.Collections.Generic;
using System.Data.SqlTypes;
using Utility;

namespace SQLLibB1.Address
{
    public static class AddressFormatter
    {
        public static readonly List<string> ggg = new List<string>() { "Аал",
"Абонентский ящик",
"Автодорога",
"Автономная область",
"Автономный округ",
"Аллея",
"Арбан",
"Аул",
"Балка",
"Берег",
"Бугор",
"Бульвар",
"Вал",
"Взвоз",
//"Владение",
"Внутригородская территория",
"Внутригородской район",
"Волость",
"Въезд",
"Выселки(ок)",
//"Гараж",
"Гаражно-строительный кооп.",
"Гаражно-строит-ный кооператив",
"Город",
"Город федерального значения",
"Городок",
"Городское поселение",
"Городской округ",
"Городской поселок",
"Дачное неком-е партнерство",
"Дачный поселок",
"Деревня",
//"Дом",
//"Домовладение",
"Дорога",
"ж/д останов. (обгонный) пункт",
"Железнодорожная будка",
"Железнодорожная ветка",
"Железнодорожная казарма",
"Железнодорожная платформа",
"Железнодорожная площадка",
"Железнодорожная станция",
"Железнодорожный блокпост",
"Железнодорожный комбинат",
"Железнодорожный остановочный пункт",
"Железнодорожный пост",
"Железнодорожный путевой пост",
"Железнодорожный разъезд",
"Животноводческая точка",
"Жилая зона",
"Жилой район",
"Заезд",
"Заимка",
//"Здание",
"Земельный участок",
"Зимовье",
"Зона",
"Зона (массив)",
"Казарма",
"Квартал",
//"Квартира",
"Километр",
"Кишлак",
"Кольцо",
"Комната",
"Кордон",
//"Корпус",
"Коса",
"Котельная",
"Край",
"Курортный поселок",
"Леспромхоз",
"Линия",
"Магистраль",
"Массив",
"Машино-место",
"Маяк",
"Местечко",
"Местность",
"Месторождение",
"Микрорайон",
"Мост",
"Муниципальный район",
"Набережная",
"Населенный пункт",
"Некоммерческое партнерство",
"Область",
"Объект незав. строительства",
"Округ",
"Остров",
//"Офис",
//"Павильон",
"Парк",
"Переезд",
"Переулок",
"Планировочный район",
"Платформа",
"Площадка",
"Площадь",
"Погост",
"Погреб",
//"Подвал",
"Полустанок",
//"Помещение",
"Порт",
"Поселение",
"Поселок",
"Поселок городского типа",
"Поселок и(при) станция(и)",
"Поселок при железнодорожной станции",
"Починок",
//"Почтовое отделение",
"Проезд",
"Промзона",
"Промышленная зона",
"Промышленный район",
"Просек",
"Просека",
"Проселок",
"Проспект",
"Проулок",
"Рабочий поселок",
"Рабочий участок",
"Разъезд",
"Район",
"Республика",
"Ряд(ы)",
"Ряды",
"Сад",
"Садовое неком-е товарищество",
"Садовое товарищество",
"Село",
"Сельская администрация",
"Сельский округ",
"Сельское муницип.образование",
"Сельское поселение",
"Сельсовет",
"Сквер",
"Склад",
"Слобода",
//"Сооружение",
"Спуск",
"Станица",
"Станция",
//"Строение",
"Съезд",
"Территория",
"Территория ГСК",
"Территория ДНО",
"Территория ДНП",
"Территория ДНТ",
"Территория ДПК",
"Территория ОНО",
"Территория ОНП",
"Территория ОНТ",
"Территория ОПК",
"Территория ПК",
"Территория СНО",
"Территория СНП",
"Территория СНТ",
"Территория СОСН",
"Территория СПК",
"Территория ТСЖ",
"Территория ТСН",
"Территория ФХ",
"Торговый зал",
"Тракт",
"Тупик",
"Улица",
"Улус",
"Усадьба",
"Участок",
"Ферма",
"Фермерское хозяйство",
"Хутор",
"Цех",
"Чувашия",
"Шахта",
"Шоссе",
"Юрты"
};
        [SqlFunction(IsDeterministic =true)]
        
        public static string To_fias(SqlString input)
        {
            ggg.Sort(new ToFiasComparer());
            return AddressOperator.To_fias_AO_inter(input.ToString(), ggg);
        }

        [SqlFunction]
        public static string CleanToSearch(SqlString input)
        {
            return AddressOperator.CleanToSearch(input.ToString());
        }

        [SqlFunction]
        public static string To_fias_Cleaned(SqlString input)
        {
            return To_fias(CleanToSearch(input));
        }

        [SqlFunction]
        public static SqlBoolean Compare(SqlString address1, SqlString address2)
        {
            return To_fias(CleanToSearch(address1.ToString())) == To_fias(CleanToSearch(address2.ToString()));
        }
    }
}
